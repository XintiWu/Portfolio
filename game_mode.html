<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŠæˆ²æ¨¡å¼ - 3Dè¡—æ©ŸéŠæˆ²æ©Ÿ</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            color: white;
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden;
        }
        
        #arcade-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        .test-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #3b82f6;
            z-index: 1000;
            max-width: 300px;
        }
        
        .test-info h2 {
            margin: 0 0 10px 0;
            color: #3b82f6;
            font-size: 18px;
        }
        
        .test-info p {
            margin: 5px 0;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #4ECDC4;
            z-index: 1000;
        }
        
        .controls h3 {
            margin: 0 0 10px 0;
            color: #4ECDC4;
            font-size: 16px;
        }
        
        .controls p {
            margin: 3px 0;
            font-size: 12px;
            color: #ccc;
        }
        
        .level-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ffd700;
            z-index: 1000;
            text-align: center;
        }
        
        .level-indicator h3 {
            margin: 0 0 10px 0;
            color: #ffd700;
            font-size: 16px;
        }
        
        .level-indicator .level-number {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
        }
        
        .level-indicator .progress-bar {
            width: 200px;
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .level-indicator .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ECDC4, #3b82f6);
            transition: width 0.3s ease;
        }
        
        
        /* ä¸»é æ¨¡å¼åˆ‡æ›é–‹é—œ */
        .home-mode-switch {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex !important;
            align-items: center;
            gap: 12px;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #3b82f6;
            border-radius: 10px;
            padding: 15px;
            z-index: 10000;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            min-width: 120px;
            opacity: 1;
            visibility: visible;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 20px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ffffff;
            transition: all 0.3s ease;
            border-radius: 20px;
            border: 1px solid #1e3a8a;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 1px;
            bottom: 1px;
            background-color: #1e3a8a;
            transition: all 0.3s ease;
            border-radius: 50%;
        }
        
        /* é–‹å•Ÿç‹€æ…‹ - æ·±è—è‰²èƒŒæ™¯ï¼Œç™½è‰²æ»‘å¡Š */
        input:checked + .slider {
            background-color: #1e3a8a;
            border-color: #1e3a8a;
        }
        
        input:checked + .slider:before {
            transform: translateX(24px);
            background-color: #ffffff;
        }
        
        /* æ‡¸åœæ•ˆæœ */
        .slider:hover {
            border-color: #2563eb;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.3);
        }
        
        input:checked + .slider:hover {
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
        }
        
        .switch-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 1px;
            color: #ffffff;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        
        .switch-label::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #3b82f6, #1e3a8a);
            transition: width 0.3s ease;
        }
        
        .home-mode-switch:hover .switch-label {
            color: #3b82f6;
            text-shadow: 0 0 10px #3b82f6;
        }
        
        .home-mode-switch:hover .switch-label::after {
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="arcade-container"></div>
    
    <div class="test-info">
        <h2>ğŸ® éŠæˆ²æ¨¡å¼ä»‹ç´¹</h2>
        <p><strong>åŠŸèƒ½èªªæ˜ï¼š</strong></p>
        <p>â€¢ æ‹–ç§»å¯æ—‹è½‰éŠæˆ²æ©Ÿ</p>
        <p>â€¢ é»æ“ŠéŠæˆ²æ©Ÿé€²å…¥éŠæˆ²</p>
        <p></p>
        <p>â€¢ åƒè±†äººï¼šåƒå®ŒCHLOEè±†å­</p>
        <p>â€¢ å¤ªç©ºä¾µç•¥è€…ï¼šæ¶ˆæ»…XINTIä¾µç•¥è€…</p>
        <p></p>
        <p>â€¢ å®Œæˆå…©é—œå¾Œå³å¯é€šé—œ</p>
    </div>
    
    <div class="level-indicator">
        <h3>ğŸ® éŠæˆ²æ¨¡å¼</h3>
        <div class="level-number" id="level-display">åƒè±†äºº</div>
        <div id="progress-text">ç›®æ¨™: å®Œæˆä¸€æ¬¡éŠæˆ²</div>
    </div>
    
    <div class="controls">
        <h3>ğŸ¯ éŠæˆ²æ§åˆ¶</h3>
        <p><strong>ç§»å‹•ï¼š</strong> A/D æˆ– â†/â†’</p>
        <p><strong>å°„æ“Šï¼š</strong> ç©ºç™½éµ</p>
        <p><strong>åˆ‡æ›éŠæˆ²ï¼š</strong> G éµ</p>
        <p><strong>è¦–è§’åˆ‡æ›ï¼š</strong> é»æ“Šè¢å¹•</p>
        <p><strong>é€€å‡ºéŠæˆ²ï¼š</strong> ESC éµ</p>
    </div>
    
    
    <!-- ä¸»é æ¨¡å¼åˆ‡æ›é–‹é—œ -->
    <div class="home-mode-switch">
        <span class="switch-label">ä¸»é æ¨¡å¼</span>
        <label class="switch">
            <input type="checkbox" id="homeModeToggle">
            <span class="slider"></span>
        </label>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    
    <!-- éŠæˆ²ä¸»ç¨‹å¼ -->
    <script src="arcade3d.js"></script>
    
    <script>
        // åˆå§‹åŒ–éŠæˆ²
        let arcadeMachine;
        
        // ç­‰å¾…é é¢è¼‰å…¥å®Œæˆ
        window.addEventListener('load', () => {
            console.log('ğŸ® é–‹å§‹åˆå§‹åŒ–é—œå¡ç³»çµ±æ¸¬è©¦...');
            
            // å‰µå»ºè¡—æ©ŸéŠæˆ²æ©Ÿå¯¦ä¾‹
            arcadeMachine = new ArcadeMachine3D();
            
            // ç›£è½é—œå¡è®ŠåŒ–äº‹ä»¶
            document.addEventListener('levelChanged', (event) => {
                updateLevelDisplay(event.detail);
            });
            
            // ç›£è½é€²åº¦è®ŠåŒ–äº‹ä»¶
            document.addEventListener('progressChanged', (event) => {
                updateProgressDisplay(event.detail);
            });
            
            console.log('âœ… é—œå¡ç³»çµ±æ¸¬è©¦åˆå§‹åŒ–å®Œæˆï¼');
        });
        
        function updateLevelDisplay(gameModeData) {
            const levelDisplay = document.getElementById('level-display');
            const progressText = document.getElementById('progress-text');
            
            let modeText = '';
            switch(gameModeData.gameMode) {
                case 'pacman':
                    modeText = 'ğŸ‘» åƒè±†äºº';
                    break;
                case 'space_invaders':
                    modeText = 'ğŸ‘½ å¤ªç©ºä¾µç•¥è€…';
                    break;
            }
            
            levelDisplay.textContent = modeText;
            progressText.textContent = 'ç›®æ¨™: å®Œæˆä¸€æ¬¡éŠæˆ²';
            progressText.style.color = '#fff';
        }
        
        // å®šæœŸæ›´æ–°é¡¯ç¤º
        setInterval(() => {
            if (arcadeMachine && arcadeMachine.gameState) {
                const gameState = arcadeMachine.gameState;
                
                updateLevelDisplay({
                    gameMode: gameState.gameMode
                });
            }
        }, 100);
        
        
        // ä¸»é æ¨¡å¼åˆ‡æ›åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', () => {
            const homeModeToggle = document.getElementById('homeModeToggle');
            if (homeModeToggle) {
                // åˆå§‹åŒ–ï¼šåœ¨éŠæˆ²æ¨¡å¼é é¢ï¼Œswitchæ‡‰è©²é¡¯ç¤ºç‚ºé–‹å•Ÿç‹€æ…‹ï¼ˆæŒ‰éˆ•åœ¨å³é‚Šï¼‰
                homeModeToggle.checked = true;
                
                homeModeToggle.addEventListener('change', function() {
                    // ä¿®æ”¹é‚è¼¯ï¼šåªè¦æŒ‰éˆ•å¾€å·¦ï¼ˆuncheckedï¼‰å°±åˆ‡å›ä¸»é æ¨¡å¼
                    if (!this.checked) {
                        console.log('ğŸ  åˆ‡æ›åˆ°ä¸»é æ¨¡å¼');
                        // æ·»åŠ åˆ‡æ›å‹•ç•«æ•ˆæœ
                        this.parentElement.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            this.parentElement.style.transform = 'scale(1)';
                        }, 200);
                        
                        // å»¶é²è·³è½‰ä»¥é¡¯ç¤ºå‹•ç•«æ•ˆæœ
                        setTimeout(() => {
                            window.location.href = 'index.html';
                        }, 300);
                    }
                });
                
                // ç‚ºæ¨™ç±¤æ·»åŠ é»æ“Šäº‹ä»¶
                const homeSwitchLabel = document.querySelector('.home-mode-switch .switch-label');
                if (homeSwitchLabel) {
                    homeSwitchLabel.addEventListener('click', function() {
                        // é»æ“Šæ¨™ç±¤æ™‚ç›´æ¥åˆ‡æ›åˆ°ä¸»é æ¨¡å¼ï¼ˆæŒ‰éˆ•å¾€å·¦ï¼‰
                        homeModeToggle.checked = false;
                        homeModeToggle.dispatchEvent(new Event('change'));
                    });
                }
                
                console.log('âœ… ä¸»é æ¨¡å¼åˆ‡æ›é–‹é—œå·²åˆå§‹åŒ–ï¼ˆéŠæˆ²æ¨¡å¼ç‹€æ…‹ï¼‰');
            } else {
                console.error('âŒ ä¸»é æ¨¡å¼åˆ‡æ›é–‹é—œæœªæ‰¾åˆ°');
            }
        });
    </script>
</body>
</html>
